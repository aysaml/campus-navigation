webpackJsonp([4],{"/U6l":function(e,t,a){var i={"./NewsManage.vue":"IyQJ"};function l(e){return a(s(e))}function s(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}l.keys=function(){return Object.keys(i)},l.resolve=s,e.exports=l,l.id="/U6l"},IyQJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),l=a.n(i),s={data:function(){return{places:[],multipleSelection:[],options:[{value:"0",label:"校内新闻"},{value:"1",label:"其他新闻"}],totals:0,pageNum:1,pageSize:10,state:"",centerDialogVisible:!1,dialogFormVisible:!1,visible:!1,form:{id:"",title:"",content:""},news:{title:"",outline:"",content:"",imgUrl:"",author:"",source:"",type:""}}},mounted:function(){this.loadPlaces(),this.loadPlacesCount()},methods:{loadPlaces:function(){var e=this;this.getRequest("/news/getNewsList?pageNum=1&pageSize=10&type=0").then(function(t){if(t&&200==t.status){var a=t.data.data;e.places=a}})},loadPlacesCount:function(){var e=this;this.getRequest("/news/getNewsCount?type=0").then(function(t){if(t&&200==t.status){var a=t.data.data;e.totals=a}})},handleSizeChange:function(e){var t=this;t.pageSize=e,this.getRequest("/news/getNewsList?pageNum="+t.pageNum+"&pageSize="+t.pageSize+"&type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.places=a}}),this.getRequest("/news/getNewsCount?type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.totals=a}})},handleCurrentChange:function(e){var t=this;t.pageNum=e,this.getRequest("/news/getNewsList?pageNum="+t.pageNum+"&pageSize="+t.pageSize+"&type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.places=a}}),this.getRequest("/news/getNewsCount?type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.totals=a}})},stateChange:function(e){""!=e&&null!=e||(e=0);var t=this;t.state=e,this.getRequest("/news/getNewsList?pageNum="+t.pageNum+"&pageSize="+t.pageSize+"&type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.places=a}}),this.getRequest("/news/getNewsCount?type="+t.state).then(function(e){if(e&&200==e.status){var a=e.data.data;t.totals=a}})},delPlace:function(e){var t=this;this.$confirm("此操作将永久删除["+e.title+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.doDelete(e.id)}).catch(function(){})},doDelete:function(e){var t=this;this.deleteRequest("/news/manage/delete?id="+e).then(function(e){0==e.data.state&&200==e.status&&(t.centerDialogVisible=!0,t.loadPlaces(),t.loadPlacesCount())})},examine:function(e){this.dialogFormVisible=!0,this.form.id=e.id,this.form.title=e.title,this.form.content=e.content},updatePlace:function(){var e=this,t={id:e.form.id,title:e.form.title,content:e.form.content};""!=t.title&&null!=t.title?""!=t.content&&null!=t.content?(this.postJson("/news/manage/update",l()(t)).then(function(t){t&&200==t.status&&0==t.data?(e.success(),e.loadPlaces(),e.loadPlacesCount()):e.failed()}),e.dialogFormVisible=!1):this.$message.error("新闻内容不能为空"):this.$message.error("新闻标题不能为空")},success:function(){this.$message({message:"操作成功！",type:"success"})},failed:function(){this.$message.error("操作失败！")},addNews:function(){this.visible=!0},add:function(){var e=this,t={title:e.news.title,outline:e.news.outline,content:e.news.content,imgUrl:e.news.imgUrl,author:e.news.author,source:e.news.source,type:e.news.type};""!=t.title&&null!=t.title?""!=t.content&&null!=t.content?this.postJson("/news/manage/add",l()(t)).then(function(t){t&&200==t.status?(e.success(),e.visible=!1,e.loadPlaces(),e.loadPlacesCount(),e.news.title="",e.news.outline="",e.news.content="",e.news.imgUrl="",e.news.author="",e.news.source="",e.news.type=""):e.failed()}):this.$message.error("新闻内容不能为空"):this.$message.error("新闻标题不能为空")},uploadFile:function(e){var t="image/PNG"===e.type,a=e.size/1024<500;return t?(this.$message.error("只能上传PNG图片文件！"),!1):a?void 0:(this.$message.error("上传图片大小不能超过 500KB!"),!1)},uploadSuccess:function(e,t,a){4e3==e.state?(this.$message({message:"图片上传成功！",type:"success"}),this.news.imgUrl=e.data):this.$message.error("图片上传失败！刷新页面重试！")}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("新闻管理")]),e._v(" "),a("el-select",{staticStyle:{width:"130px"},attrs:{size:"small",placeholder:"新闻类型",clearable:""},on:{change:e.stateChange},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"small"},on:{click:e.addNews}},[e._v("发布新闻")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.places,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"内容",align:"left"}},[a("span",[e._v(e._s(t.row.content))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ID",prop:"id",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"作者",prop:"author",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"来源",prop:"source",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"type",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",circle:""},on:{click:function(a){e.examine(t.row)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(a){e.delPlace(t.row)}}})]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totals},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("span",[e._v("操作成功！")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),a("el-form",{staticStyle:{margin:"0px",padding:"0px"},attrs:{model:e.form}},[a("div",{staticStyle:{"text-align":"left"}},[a("el-dialog",{staticStyle:{padding:"0px"},attrs:{title:"修改","close-on-click-modal":!1,visible:e.dialogFormVisible,width:"77%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("div",[a("el-form-item",{attrs:{label:"编号:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",disabled:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",[a("el-form-item",{attrs:{label:"标题:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1)])],1),e._v(" "),a("el-row",[a("div",[a("el-form-item",{attrs:{label:"新闻内容："}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.content,expression:"form.content"}],staticStyle:{width:"956px",height:"104px"},domProps:{value:e.form.content},on:{input:function(t){t.target.composing||e.$set(e.form,"content",t.target.value)}}})])],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updatePlace}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{"text-align":"left"}},[a("el-dialog",{staticStyle:{padding:"0px"},attrs:{title:"发布新闻","close-on-click-modal":!1,visible:e.visible,width:"77%"},on:{"update:visible":function(t){e.visible=t}}},[a("el-row",[e._v("\n          新闻图片：\n          "),a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"/upload","before-upload":e.uploadFile,"on-success":e.uploadSuccess,limit:1}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])]),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",[a("el-form-item",{attrs:{label:"标题:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini",clearable:""},model:{value:e.news.title,callback:function(t){e.$set(e.news,"title",t)},expression:"news.title"}})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",[a("el-form-item",{attrs:{label:"作者:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini"},model:{value:e.news.author,callback:function(t){e.$set(e.news,"author",t)},expression:"news.author"}})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",[a("el-form-item",{attrs:{label:"来源:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini"},model:{value:e.news.source,callback:function(t){e.$set(e.news,"source",t)},expression:"news.source"}})],1)],1)]),e._v("\n          类型：\n            "),a("el-select",{staticStyle:{width:"130px"},attrs:{size:"small",placeholder:"新闻类型",clearable:""},model:{value:e.news.type,callback:function(t){e.$set(e.news,"type",t)},expression:"news.type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-row",[a("div",[a("el-form-item",{attrs:{label:"新闻梗概："}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.news.outline,expression:"news.outline"}],staticStyle:{width:"956px",height:"104px"},domProps:{value:e.news.outline},on:{input:function(t){t.target.composing||e.$set(e.news,"outline",t.target.value)}}})])],1)]),e._v(" "),a("el-row",[a("div",[a("el-form-item",{attrs:{label:"新闻内容："}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.news.content,expression:"news.content"}],staticStyle:{width:"956px",height:"104px"},domProps:{value:e.news.content},on:{input:function(t){t.target.composing||e.$set(e.news,"content",t.target.value)}}})])],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1)],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(s,n,!1,function(e){a("dD5w")},null,null);t.default=o.exports},dD5w:function(e,t){}});
//# sourceMappingURL=4.c5d808313d66ac30ef0a.js.map